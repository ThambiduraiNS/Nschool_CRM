{% extends 'base.html' %}

{% load static %}
{% load bootstrap_icons %}
{% load custom_filters %}


{% block title %}User Module{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static '/css/new_user.css' %}">
<link rel="stylesheet" href="{% static '/css/header.css' %}">
<link rel="stylesheet" href="{% static '/css/new_enquiry.css' %}">
<link rel="stylesheet" href="{% static '/css/update_enquiry.css' %}">
{% endblock %}

{% block header %}
{% include 'header.html' %}
{% endblock %}

{% block content %}
<!-- <div class="container-fluid"> -->
<div class="row m-0 p-0">
    {% include 'side_navbar.html' %}

    <div class="col-12 col-lg-10 background-div">

        <div class="row m-0 p-0">
            <div class="col border bg-white rounded mt-4 ms-xll-4 mb-2 px-xll-4">
                <nav style="--bs-breadcrumb-divider: '|';" aria-label="breadcrumb">
                    <ol class="breadcrumb pt-3 mb-3 ps-lg-3">
                        <li class="breadcrumb-item"><a class="user-a" href="#">Enquiry</a></li>
                        <li class="breadcrumb-item active" aria-current="page">New Enquiry</li>
                    </ol>
                </nav>
            </div>
        </div>
        

        <div class="row m-0 p-0">
            <div class="col border bg-white rounded mt-2 ms-xll-4 mb-2 px-xll-4">

                <!-- Tab Content -->
                <form id="enquiry_form"  enctype="multipart/form-data" class="pe-lg-2" action="" method="post">
                    {% csrf_token %}
                    <div class="row m-0 p-0">
                            <div class="col-12 mt-4 ms-md-2 position-relative">
                                <h5 class="fw-bold st-details">Notes</h5>
                                <span class="message" id="message">
                                    {% for message in messages %}
                                    <div>
                                        {{ message }}
                                    </div>
                                    {% endfor %}

                                </span>
                                <span id="notes_error" class="error-div notes-error-div">
                                    
                                </span>
                            </div>

                            <!-- Note field -->
                            <div class="col-12 col-md-12">
                                <div class="user-input-wrp me-md-4 mt-md-5">
                                    <div class="notes">
                                        <!-- <form id="notes_form" class="pe-lg-2" action="" method="post"> -->
                                        <textarea name="notes" id="notes" class="form-control text-area text-notes" rows="5" cols="40" placeholder="Add input" autocomplete="off" autofocus></textarea>
                                        <!-- <label class="floating-label">&nbsp;Add input&nbsp;</label> -->
                                        <div class="d-flex container">
                                            <div class="col-6 fileUploadInput">
                                                <button>
                                                    <?xml version="1.0" ?><svg fill="none" height="28" viewBox="0 0 28 28" width="28" xmlns="http://www.w3.org/2000/svg"><path d="M12.4797 4.15793C14.6095 0.833113 19.0267 -0.132589 22.3457 2.00098C25.6648 4.13454 26.6288 8.55944 24.4989 11.8843L22.6498 10.6956C24.1243 8.39379 23.4569 5.3304 21.1591 3.85332C18.8614 2.37624 15.8033 3.0448 14.3288 5.3466L12.4797 4.15793Z" fill="black"/><path d="M14.3278 5.34752L5.1311 19.7042C4.14959 21.2384 4.5946 23.2789 6.12591 24.263C7.65789 25.2475 9.69685 24.8018 10.68 23.2674L13.0534 19.5629L13.0519 19.5619L18.9849 10.3002L18.9863 10.3012C19.4777 9.53391 19.2553 8.51284 18.4894 8.0205C17.7234 7.52814 16.7041 7.751 16.2126 8.51826L16.2111 8.51733L11.5 16.001C11.2118 16.4509 10.6138 16.5814 10.1643 16.2925L9.94284 16.1501C9.49339 15.8612 9.36268 15.2622 9.65088 14.8123L14.3621 7.32857L14.3635 7.3295C15.5104 5.53929 17.8888 5.01934 19.676 6.16816C21.4631 7.317 21.9822 9.69964 20.8354 11.4899L20.8339 11.489L18.4613 15.1927L18.4632 15.1939L12.5297 24.4564C10.891 27.0135 7.49232 27.756 4.93909 26.1152C2.38578 24.4743 1.64432 21.071 3.28299 18.5136L12.4787 4.15885L14.3278 5.34752Z" fill="black"/><path d="M15.4516 23.7222C15.0022 23.4333 14.8715 22.8343 15.1597 22.3844L22.6473 10.6957L24.4965 11.8844L17.0088 23.5731C16.7206 24.023 16.1226 24.1535 15.6731 23.8646L15.4516 23.7222Z" fill="black"/></svg>
                                                </button>
                                                <!-- <span class="slash-span">|</span> -->
                                                <input type="file" id="files" name="files" />
                                            </div>
                                            <div class="col-6 d-flex justify-content-lg-end ps-lg-4 p-0 pe-4 gap-5">
                                                <button type="reset" class="btn login-btn nav-link active " id="notes-tab" data-bs-toggle="tab" data-bs-target="#notes" type="button" role="tab" aria-controls="notes" aria-selected="true">Cancel</button>
                                                <input type="submit" value="save" class="btn login-btn w-25">
                                            </div>
                                        </div>
                                    </div>               
                                </div>
                            </div>
                        </div>    
                    </div>         
                    
                </form>
            </div>
        </div>
    </div>
</div>
<!-- </div> -->

{% endblock %}


{% block scripts %}
<script>
    // dropdown functionality
    function toggleDropdown(element) {
        // Close all dropdowns
        const allDropdowns = document.querySelectorAll('.dropdown-menu');
        allDropdowns.forEach(dropdown => {
            if (dropdown !== element.nextElementSibling) {
                dropdown.classList.remove('show');
            }
        });

        // Close all arrows
        const allArrows = document.querySelectorAll('.right_arrow');
        allArrows.forEach(arrow => {
            if (arrow !== element.querySelector('.right_arrow')) {
                arrow.classList.remove('arrow_user');
            }
        });

        // Toggle the clicked dropdown and arrow
        const dropdownMenu = element.nextElementSibling;
        dropdownMenu.classList.toggle('show');
        const rightArrow = element.querySelector('.right_arrow');
        rightArrow.classList.toggle('arrow_user');
    }

    document.getElementById('toggle-sidenav').addEventListener('click', function () {
        const sidenav = document.getElementById('sidenav');
        sidenav.classList.toggle('collapsed');
    });
    
    // validation

    document.getElementById('enquiry_form').addEventListener('submit', function(event) {
        console.log("form function trigred")
        event.preventDefault();
        let hasError = false;    

        // Student Name Validation
        var notes = document.getElementById('notes').value.trim();
        if (notes === "") {
            document.getElementById('notes_error').innerText = "This Field is required.";
            hasError = true;
        } else {
            document.getElementById('notes_error').innerText = "";
        }

        if (!hasError) {
            document.getElementById("enquiry_form").submit();
        }
    });

    function permission(checkboxId) {
        // Get the checkbox
        console.log("permission function")
        var checkBox = document.getElementById(checkboxId);
        // Get the output text
        // var text = document.getElementById('text_' + checkboxId);

        // If the checkbox is checked, display the output text
        if (checkBox.checked) {
            checkBox.value = true;
        } else {
            checkBox.value = false;
        }
    }

    function showMessage() {
        const alertBox = document.getElementById('message');
        alertBox.style.display = 'block';

        setTimeout(() => {
            alertBox.style.display = 'none';
        }, 5000);
    }
</script>
{% endblock %}