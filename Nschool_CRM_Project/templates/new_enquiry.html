{% extends 'base.html' %}

{% load static %}
{% load bootstrap_icons %}


{% block title %}Enquiry Module{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static '/css/new_user.css' %}">
<link rel="stylesheet" href="{% static '/css/header.css' %}">
<link rel="stylesheet" href="{% static '/css/new_enquiry.css' %}">
<!-- Flatpickr CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
{% endblock %}

{% block header %}
{% include 'header.html' %}
{% endblock %}

{% block content %}
<!-- <div class="container-fluid"> -->
<div class="row m-0 p-0">
    {% include 'side_navbar.html' %}

    <div class="col-12 col-lg-10 background-div">

        <div class="row m-0 p-0">
            <div class="col border bg-white rounded mt-4 ms-xll-4 mb-2 px-xll-4">
                <nav style="--bs-breadcrumb-divider: '|';" aria-label="breadcrumb">
                    <ol class="breadcrumb pt-3 mb-3 ps-lg-3">
                        <li class="breadcrumb-item"><a class="user-a" href="#">Enquiry</a></li>
                        <li class="breadcrumb-item active" aria-current="page">New Enquiry</li>
                    </ol>
                </nav>
            </div>
        </div>

        
        <div class="row m-0 p-0">
            <div class="col border-end bg-white rounded ms-xll-4 mb-2 p-0">
                <!-- Tab Navigation -->
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">Student Details</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false">Education Details</button>
                    </li>
                </ul>
            </div>
        </div>
        

        <div class="row m-0 p-0">
            <div class="col border bg-white rounded mt-2 ms-xll-4 mb-2 px-xll-4">

                <!-- Tab Content -->
                <form id="enquiry_form" class="pe-lg-2" action="" method="post">
                    <!-- Student details -->
                    <div class="tab-content" id="myTabContent">
                        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                            <div class="row m-0 p-0">
                                    {% csrf_token %}
                                    <div class="col-12 mt-4 ms-md-2 position-relative">
                                        <h5 class="fw-bold st-details">Student Details</h5>
                                        <p class="user-para">Use the below form to update your profile</p>
                                        <span class="message" id="message">
                                            {% for message in messages %}
                                            <div>
                                                {{ message }}
                                            </div>
                                        {% endfor %}
                                        </span>
                                    </div>

                                    <!-- date field -->
                                    <div class="row d-flex justify-content-between pe-0">
                                        <div class="col-12 col-md-6">
                                            <div class="user-input-wrp mx-md-2">
                                                <input type="date" name="enquiry_date" id="enquiry_date" value="{{enquiry_date}}" class="form-control bg-white"
                                                    aria-label="date" placeholder=" " autocomplete="off" autofocus>
                                                <label class="floating-label">&nbsp;Date <span class="required">*</span> &nbsp;</label>
                                                <span id="date_error" class="error-div">
                                                    {% if errors.enquiry_date %}
                                                        {{errors.enquiry_date}}
                                                    {% endif %}
                                                </span>
                                            </div>
                                        </div>
                                        
                                        <!-- enquiry number field -->
                                        <div class="col-12 col-md-6 p-0">
                                            <div class="user-input-wrp ms-4">
                                                <input type="text" name="enquiry_number" id="enquiry_number" value="{{enquiry_no}}" class="form-control"
                                                    aria-label="number" placeholder=" " autocomplete="off" autofocus>
                                                <label class="floating-label">&nbsp;Enquiry No <span class="required">*</span> &nbsp;</label>
                                                <span id="enquiry_no_error" class="error-div">
                                                    {% if errors.enquiry_no %}
                                                        {{errors.enquiry_no}}
                                                    {% endif %}
                                                </span>
                                            </div>
                                        </div>
                                        
                                        <!-- student name field -->
                                        <div class="col-12 col-md-6">
                                            <div class="user-input-wrp mx-md-2">
                                                <input type="text" name="student_name" id="student_name" value="{{name}}" class="form-control"
                                                    aria-label="student_name" placeholder=" " autocomplete="off" autofocus>
                                                <label class="floating-label">&nbsp;Name <span class="required">*</span> &nbsp;</label>
                                                <span id="user_error" class="error-div">
                                                    {% if errors.name %}
                                                        {{errors.name}}
                                                    {% endif %}
                                                </span>
                                            </div>
                                        </div>
            
                                        <!-- student contact number field -->
                                        <div class="col-12 col-md-6 p-0">
                                            <div class="user-input-wrp ms-4">
                                                <input type="text" name="contact" id="contact" value="{{contact_no}}" maxlength="10" class="form-control"
                                                    aria-label="contact" placeholder=" " autocomplete="off" autofocus>
                                                <label class="floating-label">&nbsp;Contact No <span class="required">*</span> &nbsp;</label>
                                                <span id="contact_error" class="error-div">
                                                    {% if errors.contact_no %}
                                                        {{ errors.contact_no }}
                                                    {% endif %}
                                                </span>
                                            </div>
                                        </div>
            
                                        <!-- student email field -->
                                        <div class="col-12 col-md-6">
                                            <div class="user-input-wrp mx-md-2">
                                                <input type="email" name="email" id="email" value="{{email_id}}" class="form-control" placeholder=" "
                                                    autocomplete="off" autofocus>
                                                <label class="floating-label">&nbsp;E-Mail-ID <span class="required">*</span> &nbsp;</label>
                                                <span id="email_error" class="error-div error-right">
                                                    {% if errors.email_id %}
                                                        {{errors.email_id}}
                                                    {% endif %}
                                                </span>
                                            </div>
                                        </div>
                                        
                                        <!-- student date of birth field -->
                                        <div class="col-12 col-md-6 p-0">
                                            <div class="user-input-wrp ms-4">
                                                <input type="date" name="dob" id="dob" value="{{date_of_birth}}" class="form-control bg-white" placeholder=" "
                                                    autocomplete="off" autofocus>
                                                <label class="floating-label">&nbsp;Date Of Birth&nbsp;</label>
                                                <span id="dob_error" class="error-div error-right">
                                                    {% if errors.date_of_birth %}
                                                        {{errors.date_of_birth}}
                                                    {% endif %}
                                                </span>
                                            </div>
                                        </div>

                                        <!-- student father name / guardian field -->
                                        <div class="col-12 col-md-6">
                                            <div class="user-input-wrp mx-md-2">
                                                <input type="text" name="father_name" id="father_name" value="{{father_name}}" class="form-control" placeholder=" "
                                                    autocomplete="off" autofocus>
                                                <label class="floating-label">&nbsp;Father's Name / Guardian's Name&nbsp;</label>
                                                <span id="father_name_error" class="error-div error-right">
                                                    {% if errors.fathers_name %}
                                                        {{errors.fathers_name}}
                                                    {% endif %}
                                                </span>
                                            </div>
                                        </div>

                                        <!-- Father's Contact No field -->
                                        <div class="col-12 col-md-6 p-0">
                                            <div class="user-input-wrp ms-4">
                                                <input type="text" name="father_contact" id="father_contact" value="{{fathers_contact_no}}" maxlength="10" maxlength="10" class="form-control" placeholder=" "
                                                    autocomplete="off" autofocus>
                                                <label class="floating-label">&nbsp;Father's Contact No <span class="required">*</span> &nbsp;</label>
                                                <span id="father_contact_error" class="error-div error-right">
                                                    {% if errors.fathers_contact_no %}
                                                        {{errors.fathers_contact_no}}
                                                    {% endif %}
                                                </span>
                                            </div>
                                        </div>


                                        <div class="row">
                                            <div class="col-6 pe-0">
                                                <!-- Father's Occupation field -->
                                                <div class="col-12 col-md-12 pe-md-0">
                                                    <div class="user-input-wrp mx-md-2">
                                                        <input type="text" name="fathers_occupation" id="fathers_occupation" value="{{fathers_occupation}}" class="form-control" placeholder=" "
                                                            autocomplete="off" autofocus>
                                                        <label class="floating-label">&nbsp;Father's Occupation&nbsp;</label>
                                                        <span id="father_occupation_error" class="error-div error-right">
                                                            {% if errors.fathers_occupation %}
                                                                {{errors.fathers_occupation}}
                                                            {% endif %}
                                                        </span>
                                                    </div>
                                                </div>

                                                <!-- Course Name field -->
                                                <div class="col-12 col-md-12 pe-md-0">
                                                    <div class="user-input-wrp mx-md-2 my-md-5">
                                                        <select class="form-select select" id="courseName" name="course_name" onchange="handleCourseNameChange()">
                                                            <option value="select" selected>Select Your Course</option>
                                                            {% for course in courses %}
                                                            <option value="{{ course.id }}" {% if course_name == course.id %}selected{% endif %}>{{ course.course_name }}</option>
                                                            {% endfor %}
                                                        </select>
                                                        <label for="courseName" class="floating-label float">&nbsp;Course Name <span class="required">*</span> &nbsp;</label>
                                                        <span id="course_name_error" class="error-div error-right">
                                                            {% if errors.course_name %}
                                                                {{errors.course_name}}
                                                            {% endif %}
                                                        </span>
                                                    </div>
                                                </div>

                                                <!-- Inplant Technology field -->
                                                <div class="col-12 col-md-12 pe-md-0" style="display: none;" id="technology_div">
                                                    <div class="user-input-wrp mx-md-2 mt-md-5">
                                                        <input type="text" name="technology" id="technology" value="{{inplant_technology}}" class="form-control" placeholder=" "
                                                            autocomplete="off">
                                                        <label class="floating-label">&nbsp;Technology <span class="required">*</span> &nbsp;</label>
                                                        <span id="technology_error" class="error-div error-right">
                                                            {% if errors.inplant_technology %}
                                                                {{errors.inplant_technology}}
                                                            {% endif %}
                                                        </span>
                                                    </div>
                                                </div>
                                                
                                                <!-- Internship Technology field -->
                                                <div class="col-12 col-md-12 pe-md-0" style="display: none;" id="internship_technology_div">
                                                    <div class="user-input-wrp mx-md-2 mt-md-5">
                                                        <input type="text" name="internship_technology" id="internship_technology" value="{{internship_technology}}" class="form-control" placeholder=" "
                                                            autocomplete="off" autofocus>
                                                        <label class="floating-label">&nbsp;Technology <span class="required">*</span> &nbsp;</label>
                                                        <span id="internship_technology_error" class="error-div error-right">
                                                            {% if errors.internship_technology %}
                                                                {{errors.internship_technology}}
                                                            {% endif %}
                                                        </span>
                                                    </div>
                                                </div>

                                                <div class="row">
                                                    <!-- No.of Days field -->
                                                    <div class="col-12 col-md-6 pe-md-0"  style="display: none;" id="no_of_days_div">
                                                        <div class="user-input-wrp mx-md-2">
                                                            <input type="number" name="inplant_no_of_days" id="inplant_no_of_days" value="{{inplant_no_of_days}}" class="form-control" placeholder=" "
                                                                autocomplete="off" autofocus>
                                                            <label class="floating-label">&nbsp;No.of Days <span class="required">*</span> &nbsp;</label>
                                                            <span id="inplant_no_of_days_error" class="error-div error-right">
                                                                {% if errors.inplant_no_of_days %}
                                                                    {{errors.inplant_no_of_days}}
                                                                {% endif %}
                                                            </span>
                                                        </div>
                                                    </div>

                                                    <!-- No.of Students -->
                                                    <div class="col-12 col-md-6" style="display: none;" id="no_of_students_div">
                                                        <div class="user-input-wrp me-md-2">
                                                            <input type="number" name="inplant_no_of_students" id="inplant_no_of_students" value="{{inplant_no_of_students}}" class="form-control" placeholder=" "
                                                                autocomplete="off" autofocus>
                                                            <label class="floating-label">&nbsp;No.of Students <span class="required">*</span> &nbsp;</label>
                                                            <span id="inplant_no_of_students_error" class="error-div error-right">
                                                                {% if errors.inplant_no_of_students %}
                                                                    {{errors.inplant_no_of_students}}
                                                                {% endif %}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="row">
                                                    <!-- No.of Days field -->
                                                    <div class="col-12 col-md-6 pe-md-0"  style="display: none;" id="internship_no_of_days_div">
                                                        <div class="user-input-wrp mx-md-2">
                                                            <input type="number" name="internship_no_of_days" id="internship_no_of_days" value="{{inplant_no_of_days}}" class="form-control" placeholder=" "
                                                                autocomplete="off" autofocus>
                                                            <label class="floating-label">&nbsp;No.of Days <span class="required">*</span> &nbsp;</label>
                                                            <span id="internship_no_of_days_error" class="error-div error-right">
                                                                {% if errors.internship_no_of_days %}
                                                                    {{errors.internship_no_of_days}}
                                                                {% endif %}
                                                            </span>
                                                        </div>
                                                    </div>

                                                    <!-- No.of Students -->
                                                    <div class="col-12 col-md-6" style="display: none;" id="internship_no_of_students_div">
                                                        <div class="user-input-wrp me-md-2">
                                                            <input type="number" name="internship_no_of_students" id="internship_no_of_students" value="{{inplant_no_of_students}}" class="form-control" placeholder=" "
                                                                autocomplete="off" autofocus>
                                                            <label class="floating-label">&nbsp;No.of Students <span class="required">*</span> &nbsp;</label>
                                                            <span id="internship_no_of_students_error" class="error-div error-right">
                                                                {% if errors.internship_no_of_students %}
                                                                    {{errors.internship_no_of_students}}
                                                                {% endif %}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                

                                            </div>
                                            <div class="col-6 p-0">
                                                <!-- Address field -->
                                                <div class="col-12 col-md-12 ms-md-4">
                                                    <div class="user-input-wrp ms-md-3">
                                                        <textarea name="address" id="address" class="form-control text-area p-0 m-0" rows="9" cols="1" placeholder=" " autocomplete="off" autofocus>{{ address }}</textarea>
                                                        <label class="floating-label">&nbsp;Address&nbsp;</label>
                                                        <span id="father_occupation_error" class="error-div error-right">
                                                            {% if errors.address %}
                                                                {{errors.address}}
                                                            {% endif %}
                                                        </span>
                                                    </div>
                                                </div>

                                                <!-- Next Follow-Up Date field -->
                                                <!-- <div class="col-12 col-md-12 ms-md-4">
                                                    <div class="user-input-wrp ms-md-3 mt-md-5">
                                                        <input type="text" name="next_follow_up_date" id="next_follow_up_date" class="form-control"
                                                            aria-label="date" placeholder=" " autocomplete="off" autofocus>
                                                        <label class="floating-label">&nbsp;Next Follow-Up Date <span class="required">*</span> &nbsp;</label>
                                                        <span id="next_follow_up_date_error" class="error-div">
                                                            {% if next_follow_up_date %}
                                                                {{next_follow_up_date}}
                                                            {% endif %}
                                                        </span>
                                                    </div>
                                                </div> -->
                                            </div>
                                        </div>
                                    </div>
                                    
            
                                    <div class="row d-flex justify-content-between">
                                        <div class="col-6 d-flex justify-content-md-end p-0 pe-4 pe-lg-4">
                                        </div>
                                        <div class="col-6 d-flex justify-content-lg-end ps-lg-4 p-0 ps-4 gap-5">
                                            <button class="btn login-btn" id="next-tab" onclick="next(event)">Next</button>
                                            <!-- <input type="submit" value="submit" class="btn login-btn"> -->
                                        </div>
                                    </div>

                                    
                                
                                <span>
                                    {% if error_messages %}
                                    <div class="errors-common">
                                        <ul class="ul-errors">
                                            {% for field, message in error_messages.items %}
                                                {% if message %}
                                                    <li>{{ message }}</li>
                                                {% endif %}
                                            {% endfor %}
                                        </ul>
                                    </div>
                                    {% endif %}
                                </span>
                            </div>
                        </div>

                        <!-- Education details -->
                        <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                            <div class="col-12 mt-4 ms-md-3 position-relative">
                                <h5 class="fw-bold st-details">Education Details</h5>
                                <p class="user-para">Use the below form to update your profile</p>
                                <!-- <span class="message" id="message">{{message}}</span> -->
                            </div>

                            <div class="row">
                                <div class="col">
                                    <!-- degree field -->
                                    <div class="col-12 col-md-12">
                                        <div class="user-input-wrp mx-md-3">
                                            <input type="text" name="degree" id="degree" value="{{degree}}" class="form-control"
                                                aria-label="degree" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Degree <span class="required">*</span> &nbsp;</label>
                                            <span id="degree_error" class="error-div">
                                                {% if errors.degree %}
                                                    {{errors.degree}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- grade-persentage field -->
                                    <div class="col-12 col-md-12">
                                        <div class="user-input-wrp mx-md-3 mt-md-5">
                                            <input type="text" name="grade_percentage" id="grade_percentage" value="{{grade_percentage}}" class="form-control"
                                                aria-label="collage" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Grade-Persentage&nbsp;</label>
                                            <span id="grade_percentage_error" class="error-div">
                                                {% if errors.grade_percentage %}
                                                    {{errors.grade_percentage}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col">
                                    <!-- collage field -->
                                    <div class="col-12 col-md-12">
                                        <div class="user-input-wrp me-md-4">
                                            <input type="text" name="college" id="college" value="{{college}}" class="form-control"
                                                aria-label="college" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;College <span class="required">*</span> &nbsp;</label>
                                            <span id="college_error" class="error-div">
                                                {% if errors.college %}
                                                    {{errors.college}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Year Of Graduation field -->
                                    <div class="col-12 col-md-12">
                                        <div class="user-input-wrp me-md-4 mt-md-5">
                                            <input type="text" name="year_of_graduation" maxlength="4" id="year_of_graduation" value="{{year_of_graduation}}" class="form-control"
                                                aria-label="collage" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Year Of Graduation <span class="required">*</span> &nbsp;</label>
                                            <span id="year_of_graduation_error" class="error-div">
                                                {% if errors.year_of_graduation %}
                                                    {{errors.year_of_graduation}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Mode of Enquiry -->
                        
                            <div class="col-12 mt-4 ms-md-3 position-relative">
                                <h5 class="fw-bold st-details">Mode of Enquiry</h5>
                                <p class="user-para">Use the below form to update your profile</p>
                                <!-- <span class="message" id="message">{{message}}</span> -->
                            </div>

                            <div class="row">
                                <div class="col">

                                    <!-- Mode of Enquiry field -->
                                    <div class="col-12 col-md-12">
                                        <div class="user-input-wrp mx-md-3 mb-md-5">
                                            <select name="mode_of_enquiry" id="mode_of_enquiry" class="form-select select" onchange="handleModeOfEnquiryChange()">
                                                <option value="" selected>Select Mode of Enquiry</option>
                                                {% for mode in mode_of_enquiry_choices %}
                                                    <option value="{{ mode.id }}" {% if mode.id == mode_of_enquiry %}selected{% endif %}>{{ mode.mode_of_enquiry|title }}</option>
                                                {% endfor %}
                                            </select>
                                            <label class="floating-label">&nbsp;Mode of Enquiry <span class="required">*</span> &nbsp;</label>
                                            <span id="mode_of_enquiry_error" class="error-div">
                                                {% if errors.mode_of_enquiry %}
                                                        {{errors.mode_of_enquiry}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Refferenc Name -->
                                    <div class="col-12 col-md-12" style="display: none;" id="reference_name_div">
                                        <div class="user-input-wrp mx-md-3 mb-md-5">
                                            <input type="text" name="reference_name" value="{{reference_name}}" id="reference_name" class="form-control"
                                                aria-label="collage" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Refference Name <span class="required">*</span> &nbsp;</label>
                                            <span id="reference_name_error" class="error-div">
                                                {% if errors.reference_name %}
                                                        {{errors.reference_name}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Father's Contact No field -->
                                    <div class="col-12 col-md-12" style="display: none;" id="reference_contact_div">
                                        <div class="user-input-wrp mx-md-3 mb-md-5">
                                            <input type="text" name="reference_contact" value="{{reference_contact_no}}" id="reference_contact" maxlength="10" class="form-control" placeholder=" "
                                                autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Contact No <span class="required">*</span> &nbsp;</label>
                                            <span id="reference_contact_error" class="error-div error-right">
                                                {% if errors.reference_contact_no %}
                                                        {{errors.reference_contact_no}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Others field -->
                                    <div class="col-12 col-md-12" style="display: none;" id="other_enquiry_details_div">
                                        <div class="user-input-wrp mx-md-3 mb-md-5">
                                            <input type="text" name="other_enquiry_details" value="{{other_enquiry_details}}" id="other_enquiry_details" class="form-control"
                                                aria-label="collage" placeholder=" " autocomplete="off" autofocus>
                                            <!-- <label class="floating-label">&nbsp;Refference Name&nbsp;</label> -->
                                            <span id="other_enquiry_details_error" class="error-div">
                                                {% if errors.other_enquiry_details %}
                                                        {{errors.other_enquiry_details}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                </div>
                                <div class="col">
                                    <!-- Status Field -->
                                    <div class="col-12 col-md-12">
                                        <div class="user-input-wrp ms-md-0 me-md-4 mb-md-5">
                                            <textarea name="status" id="status" class="form-control text-area" rows="5" cols="1" placeholder=" " autocomplete="off" autofocus>{{status}}</textarea>
                                            <label class="floating-label">&nbsp;Status&nbsp;</label>
                                            <span id="degree_error" class="error-div">
                                                {% if errors.status %}
                                                        {{errors.status}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <!-- Next Follow-Up Date field -->
                                        <div class="col-12 col-md-6">
                                            <div class="user-input-wrp">
                                                <input type="date" name="next_follow_up_date" id="next_follow_up_date" value="{{next_follow_up_date}}" class="form-control bg-white"
                                                    aria-label="date" placeholder=" " autocomplete="off" autofocus>
                                                <label class="floating-label">&nbsp;Next Follow-Up Date <span class="required">*</span> &nbsp;</label>
                                                <span id="next_follow_up_date_error" class="error-div">
                                                    {% if errors.next_follow_up_date %}
                                                        {{errors.next_follow_up_date}}
                                                    {% endif %}
                                                </span>
                                            </div>
                                        </div>

                                        <!-- Mode of Enquiry field -->
                                        <div class="col-12 col-md-6">
                                            <div class="user-input-wrp me-md-4 mb-md-5">
                                                <select name="lead_type" id="lead_type" class="form-select select" onchange="handleModeOfEnquiryChange()">
                                                    <option value="" selected>Select</option>
                                                    <option value="Netural">Netural</option>
                                                    <option value="Positive">Positive</option>
                                                    <option value="Dead">Dead</option>
                                        
                                                </select>
                                                <label class="floating-label">&nbsp;Lead Type <span class="required">*</span> &nbsp;</label>
                                                <span id="lead_type_error" class="error-div">
                                                    {% if errors.lead_type %}
                                                            {{errors.lead_type}}
                                                    {% endif %}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                </div>

                                <div class="row d-flex justify-content-between">
                                    <div class="col-6 d-flex justify-content-md-end p-0 pe-4 pe-lg-4">
                                    </div>
                                    <div class="col-6 d-flex justify-content-lg-end ps-lg-4 p-0 ps-4 gap-5">
                                        <button class="btn login-btn nav-link active " id="student-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">Back</button>
                                        <button class="btn login-btn" onclick="submitForm(event)">Submit</button>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- </div> -->

{% endblock %}


{% block scripts %}

<!-- Flatpickr JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

<script>
    // // tab functionality
    // document.getElementById('next-tab').addEventListener('click', function () {
    //     event.preventDefault();
    //     var profileTab = new bootstrap.Tab(document.getElementById('profile-tab'));
    //     profileTab.show();
    // });
    
    // document.getElementById('student-tab').addEventListener('click', function () {
    //     event.preventDefault();
    //     var profileTab = new bootstrap.Tab(document.getElementById('home-tab'));
    //     profileTab.show();
    // });

    // dropdown functionality
    function toggleDropdown(element) {
        // Close all dropdowns
        const allDropdowns = document.querySelectorAll('.dropdown-menu');
        allDropdowns.forEach(dropdown => {
            if (dropdown !== element.nextElementSibling) {
                dropdown.classList.remove('show');
            }
        });

        // Close all arrows
        const allArrows = document.querySelectorAll('.right_arrow');
        allArrows.forEach(arrow => {
            if (arrow !== element.querySelector('.right_arrow')) {
                arrow.classList.remove('arrow_user');
            }
        });

        // Toggle the clicked dropdown and arrow
        const dropdownMenu = element.nextElementSibling;
        dropdownMenu.classList.toggle('show');
        const rightArrow = element.querySelector('.right_arrow');
        rightArrow.classList.toggle('arrow_user');
    }

    document.getElementById('toggle-sidenav').addEventListener('click', function () {
        const sidenav = document.getElementById('sidenav');
        sidenav.classList.toggle('collapsed');
    });
    
    function validateFirstTab() {
        // Student Name Validation

        let hasError = false;

        const studentName = document.getElementById('student_name');
        if (studentName.value.trim() === "") {
            document.getElementById('user_error').innerText = "Student Name Field is required.";
            hasError = true;
        } else {
            document.getElementById('user_error').innerText = "";
        }

        // Contact Number Validation
        const contactField = document.getElementById('contact');
        if (contactField.value.trim() === "") {
            document.getElementById('contact_error').innerText = "Contact Field is required.";
            hasError = true;
        } else if (contactField.value.length !== 10 || isNaN(contactField.value)) {
            document.getElementById('contact_error').innerText = "Please enter a valid 10-digit contact number.";
            hasError = true;
        } else {
            document.getElementById('contact_error').innerText = "";
        }

        // Email Validation
        const emailField = document.getElementById('email');
        const emailError = document.getElementById('email_error');
        const emailValue = emailField.value;
        const emailPattern = /^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$/;

        if (emailValue === "") {
            emailError.textContent = "Email field is required.";
            hasError = true;
        } else if (!emailPattern.test(emailValue)) {
            emailError.textContent = "Please enter a valid email address.";
            hasError = true;
        } else {
            emailError.textContent = "";
        }

        // Father's Contact Number Validation
        const fatherContactField = document.getElementById('father_contact');
        if (fatherContactField.value.trim() === "") {
            document.getElementById('father_contact_error').innerText = "Father contact Field is required.";
            hasError = true;
        } else if (fatherContactField.value.length !== 10 || isNaN(fatherContactField.value)) {
            document.getElementById('father_contact_error').innerText = "Please enter a valid 10-digit contact number.";
            hasError = true;
        } else {
            document.getElementById('father_contact_error').innerText = "";
        }

        // Course Name Validation
        const courseName = document.getElementById('courseName').value.trim();
        if (courseName === "select") {
            document.getElementById('course_name_error').innerText = "Please select your course.";
            hasError = true;
        } else {
            document.getElementById('course_name_error').innerText = "";
        }

        // If there are no errors, return true
        console.log("Validate First Tab : ", !hasError)

        return !hasError;

    }

    function validateSecondTab() {
        console.log("Validate Second Tab!!!")
        let hasError = false;

        // Degree Validation
        const degree = document.getElementById('degree');
        if (degree.value.trim() === "") {
            document.getElementById('degree_error').innerText = "Degree Field is required.";
            hasError = true;
        } else {
            document.getElementById('degree_error').innerText = "";
        }

        // College Validation
        const college = document.getElementById('college');
        if (college.value.trim() === "") {
            document.getElementById('college_error').innerText = "College Field is required.";
            hasError = true;
        } else {
            document.getElementById('college_error').innerText = "";
        }

        // Year of Graduation Validation
        const year_of_graduation = document.getElementById('year_of_graduation');
        if (year_of_graduation.value.trim() === "") {
            document.getElementById('year_of_graduation_error').innerText = "Year of Graduation Field is required.";
            hasError = true;
        } else {
            document.getElementById('year_of_graduation_error').innerText = "";
        }

        // Mode of Enquiry Validation
        const mode_of_enquiry = document.getElementById('mode_of_enquiry');
        if (mode_of_enquiry.value.trim() === "") {
            document.getElementById('mode_of_enquiry_error').innerText = "Please Select Your Mode of Enquiry.";
            hasError = true;
        } else {
            document.getElementById('mode_of_enquiry_error').innerText = "";
        }

        // Lead Type Validation
        const lead_type = document.getElementById('lead_type').value.trim();
        if (lead_type === "") {
            document.getElementById('lead_type_error').innerText = "Please Select Your Lead Type.";
            hasError = true;
        } else {
            document.getElementById('lead_type_error').innerText = "";
        }

        return !hasError; // Return true if no errors
    }

    function next(event) {
        event.preventDefault();
        // Validate the first tab fields
        if (validateFirstTab()) {
            // Switch to the next tab if valid
            console.log("Valid!!!")
            document.querySelector('.tab-pane.active').classList.remove('show', 'active');
            document.getElementById('profile').classList.add('show', 'active');
        } else {
            // Optionally, you can focus on the first invalid input
            console.log("In Valid!!!")
            const firstErrorElement = document.querySelector('.error-div');
            console.log(firstErrorElement)
            if (firstErrorElement) {
                firstErrorElement.previousElementSibling.focus();
            }
        }
    }

    function submitForm(event) {
        event.preventDefault();

        if (validateSecondTab()) {
            // Here you can handle form submission, e.g., sending data to the server
            document.getElementById("enquiry_form").submit();
        } else {
            const firstErrorElement = document.querySelector('.error-div:not(:empty)');
            if (firstErrorElement) {
                firstErrorElement.previousElementSibling.focus();
            }
        }
    }

    function prev() {
        document.querySelector('.tab-pane.active').classList.remove('show', 'active');
        document.getElementById('home').classList.add('show', 'active');
    }

    function permission(checkboxId) {
        // Get the checkbox
        console.log("permission function")
        var checkBox = document.getElementById(checkboxId);
        // Get the output text
        // var text = document.getElementById('text_' + checkboxId);

        // If the checkbox is checked, display the output text
        if (checkBox.checked) {
            checkBox.value = true;
        } else {
            checkBox.value = false;
        }
    }

    function showMessage() {
        const alertBox = document.getElementById('message');
        alertBox.style.display = 'block';

        setTimeout(() => {
            alertBox.style.display = 'none';
        }, 5000);
    }

    document.addEventListener('DOMContentLoaded', () => showMessage());


    function handleModeOfEnquiryChange() {
        // Get the select element and its selected value
        const modeOfEnquiryElement = document.getElementById('mode_of_enquiry');
        const selectedValue = modeOfEnquiryElement.value;
        const selectedText = modeOfEnquiryElement.options[modeOfEnquiryElement.selectedIndex].text.trim().toLowerCase();

        // Get the div elements by their IDs
        const referenceNameDiv = document.getElementById('reference_name_div');
        const referenceNameInput = document.getElementById('reference_name');
        const referenceContactDiv = document.getElementById('reference_contact_div');
        const referenceContactInput = document.getElementById('reference_contact');
        const otherEnquiryDetailsDiv = document.getElementById('other_enquiry_details_div');
        const otherEnquiryDetailsInput = document.getElementById('other_enquiry_details');

        // Hide all fields initially
        referenceNameDiv.style.display = 'none';
        referenceContactDiv.style.display = 'none';
        otherEnquiryDetailsDiv.style.display = 'none';

        // Show relevant fields based on selected mode of enquiry
        if (selectedText === 'reference') {
            referenceNameDiv.style.display = 'block';
            referenceContactDiv.style.display = 'block';

            validateField(referenceNameInput, 'reference_name_error');
            validateField(referenceContactInput, 'reference_contact_error');

        } else if (selectedText === 'other' || selectedText === 'others') {
            otherEnquiryDetailsDiv.style.display = 'block';

            validateField(otherEnquiryDetailsInput, 'other_enquiry_details_error');
        }
    }

    
    function handleCourseNameChange() {
        const courseNameElement = document.getElementById('courseName');
        const courseName = courseNameElement.options[courseNameElement.selectedIndex].text.trim().toLowerCase();

        const technologyDiv = document.getElementById('technology_div');
        const internshipDiv = document.getElementById('internship_technology_div');
        const daysDiv = document.getElementById('no_of_days_div');
        const studentsDiv = document.getElementById('no_of_students_div');
        const internshipDaysDiv = document.getElementById('internship_no_of_days_div');
        const internshipStudentsDiv = document.getElementById('internship_no_of_students_div');

        const technologyInput = document.getElementById('technology');
        const internshipInput = document.getElementById('internship_technology');
        const daysInput = document.getElementById('inplant_no_of_days');
        const studentsInput = document.getElementById('inplant_no_of_students');
        const internshipNoOfDaysInput = document.getElementById('internship_no_of_days');
        const internshipNoOfStudentsInput = document.getElementById('internship_no_of_students');

        clearErrors(); // Clear previous error messages

        // Hide all fields initially
        technologyDiv.style.display = 'none';
        internshipDiv.style.display = 'none';
        daysDiv.style.display = 'none';
        studentsDiv.style.display = 'none';
        internshipDaysDiv.style.display = 'none';
        internshipStudentsDiv.style.display = 'none';

        if (courseName === 'inplant training') {
            technologyDiv.style.display = 'block';
            daysDiv.style.display = 'block';
            studentsDiv.style.display = 'block';

            
            // Validate fields
            validateField(technologyInput, 'technology_error');
            validateField(daysInput, 'inplant_no_of_days_error');
            validateField(studentsInput, 'inplant_no_of_students_error');

        } else if (courseName === 'internship training') {
            internshipDiv.style.display = 'block';
            internshipDaysDiv.style.display = 'block';
            internshipStudentsDiv.style.display = 'block';

            // Validate fields
            validateField(internshipInput, 'internship_technology_error');
            validateField(internshipNoOfDaysInput, 'internship_no_of_days_error');
            validateField(internshipNoOfStudentsInput, 'internship_no_of_students_error');
        }
    }

    function validateField(inputElement, errorElementId) {
        const errorElement = document.getElementById(errorElementId);
        if (!inputElement || !errorElement) {
            return; // Ensure elements exist
        }

        if (inputElement.value.trim() === '') {
            // If the field is empty, display an error message
            errorElement.innerText = "This field can't be empty";
            errorElement.innerText = "";
            inputElement.required = true;
        } else {
            // If the field has a value, clear the error message
            errorElement.innerText = "";
            inputElement.required = false;
        }
    }

    function clearErrors() {
        const errorElements = document.querySelectorAll('.error-div');
        errorElements.forEach(element => {
            element.innerText = "";
        });
    }


    // Function to format the current date as YYYY-MM-DD
    function getCurrentDate() {
        const today = new Date();
        const year = today.getFullYear();
        const month = String(today.getMonth() + 1).padStart(2, '0'); // Months are zero-based
        const day = String(today.getDate()).padStart(2, '0');
        return `${day}-${month}-${year}`;
    }

    // Function to format the current date as YYYY-MM-DD
    function getCurrentDateplusOne() {
        const today = new Date();
        const year = today.getFullYear();
        const month = String(today.getMonth() + 1).padStart(2, '0'); // Months are zero-based
        const day = String(today.getDate() + 1).padStart(2, '0');
        return `${day}-${month}-${year}`;
    }

    // Set the default value of the date input field to the current date
    // document.addEventListener('DOMContentLoaded', (event) => {
    //     date = getCurrentDate();
    //     console.log(date)
    //     document.getElementById('dob').value = date;
    // });

    document.addEventListener('DOMContentLoaded', function() {
        flatpickr("#dob", {
            dateFormat: "d-m-Y", // Customize the format to "DD-MM-YYYY"
            defaultDate: "today" // Optional: set default date
        });

        flatpickr("#enquiry_date", {
            dateFormat: "d-m-Y", // Customize the format to "DD-MM-YYYY"
            minDate: "today",          // Set the minimum date to today's date
            defaultDate: "today" // Optional: set default date
        });

        flatpickr("#next_follow_up_date", {
            dateFormat: "d-m-Y", // Customize the format to "DD-MM-YYYY"
            minDate: "today",          // Set the minimum date to today's date
            defaultDate: "today" // Optional: set default date
        });
    });
    
    // // Set the default value of the date input field to the current date
    // document.addEventListener('DOMContentLoaded', (event) => {
    //     document.getElementById('enquiry_date').value = date;
    //     document.getElementById('enquiry_date').setAttribute('min', date);
    // });
    
    // // Set the default value of the date input field to the current date
    // document.addEventListener('DOMContentLoaded', (event) => {
    //     document.getElementById('next_follow_up_date').value = getCurrentDateplusOne();
    //     document.getElementById('next_follow_up_date').setAttribute('min', getCurrentDate())
    // });
</script>
{% endblock %}