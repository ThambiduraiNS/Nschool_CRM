{% extends 'base.html' %}

{% load static %}
{% load bootstrap_icons %}


{% block title %}Enrollment Module{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static '/css/new_user.css' %}">
<link rel="stylesheet" href="{% static '/css/header.css' %}">
<link rel="stylesheet" href="{% static '/css/new_enquiry.css' %}">
<link rel="stylesheet" href="{% static '/css/new_enrollment.css' %}">
<!-- Flatpickr CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
{% endblock %}

{% block header %}
{% include 'header.html' %}
{% endblock %}

{% block content %}
<!-- <div class="container-fluid"> -->
<div class="row m-0 p-0">
    {% include 'side_navbar.html' %}

    <div class="col-12 col-lg-10 background-div">

        <div class="row m-0 p-0">
            <div class="col border bg-white rounded mt-4 ms-xll-4 mb-2 px-xll-4">
                <nav style="--bs-breadcrumb-divider: '|';" aria-label="breadcrumb">
                    <ol class="breadcrumb pt-3 mb-3 ps-lg-3">
                        <li class="breadcrumb-item"><a class="user-a" href="#">Enrollment</a></li>
                        <li class="breadcrumb-item active" aria-current="page">New Enrollment</li>
                    </ol>
                </nav>
            </div>
        </div>

        
        <div class="row m-0 p-0">
            <div class="col border-end bg-white rounded ms-xll-4 mb-2 p-0">
                <!-- Tab Navigation -->
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">Personal Details</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false">Education Details</button>
                    </li>
                </ul>
            </div>
        </div>
        

        <div class="row m-0 p-0">
            <div class="col border bg-white rounded mt-2 ms-xll-4 mb-2 px-xll-4">

                <!-- Tab Content -->
                <form id="enrollment_form" class="pe-lg-2" action="" method="post">
                    <!-- Student details -->
                    <div class="tab-content" id="myTabContent">
                        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                            <div class="row m-0 p-0">
                                {% csrf_token %}

                                <div class="col-12 mt-4 ms-md-2 position-relative">
                                    <h5 class="fw-bold st-details">Enrollment</h5>
                                    <p class="user-para">Use the below form to update your profile</p>
                                    <span class="message" id="message">
                                        {% for message in messages %}
                                        <div>
                                            {{ message }}
                                        </div>
                                    {% endfor %}
                                    </span>
                                </div>

                                <!-- date field -->
                                <div class="row d-flex justify-content-between pe-0">

                                    <!-- enquiry number field -->
                                    <div class="col-12 col-md-6 p-0">
                                        <div class="user-input-wrp ms-4">
                                            <input type="text" name="enquiry_no" id="enquiry_no" value="{{enquiry_no}}" class="form-control"
                                                aria-label="enquiry_no" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Enquiry No <span class="required">*</span> &nbsp;</label>
                                            <span id="enquiry_no_error" class="error-div">
                                                {% if errors.enquiry_no %}
                                                    {{errors.enquiry_no}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Registration Number Field -->
                                    <div class="col-12 col-md-6 p-0">
                                        <div class="user-input-wrp ms-5">
                                            <input type="text" name="registration_no" id="registration_no" value="{{registration_no}}" class="form-control"
                                                aria-label="registration_no" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Registration No <span class="required">*</span> &nbsp;</label>
                                            <span id="registration_no_error" class="error-div">
                                                {% if errors.registration_no %}
                                                    {{errors.registration_no}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Registration Date Field -->
                                    <div class="col-12 col-md-6 ps-0 ms-2 pe-2">
                                        <div class="user-input-wrp ms-md-3">
                                            <input type="date" name="registration_date" id="registration_date" value="{{registration_date}}" class="form-control bg-white"
                                                aria-label="registration_date" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Registration Date <span class="required">*</span> &nbsp;</label>
                                            <span id="registration_date_error" class="error-div">
                                                {% if errors.registration_date %}
                                                    {{errors.registration_date}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    
                                </div>

                                <div class="col-12 mt-4 ms-md-2 position-relative">
                                    <h5 class="fw-bold st-details">Personal Details</h5>
                                    <p class="user-para">Use the below form to update your profile</p>
                                </div>

                                <!-- student name field -->
                                <div class="col-12 col-md-6 p-0">
                                    <div class="user-input-wrp ms-md-4">
                                        <input type="text" name="name" id="name" value="{{name}}" class="form-control"
                                            aria-label="name" placeholder=" " autocomplete="off" autofocus>
                                        <label class="floating-label">&nbsp;Name <span class="required">*</span> &nbsp;</label>
                                        <span id="name_error" class="error-div">
                                            {% if errors.name %}
                                                {{errors.name}}
                                            {% endif %}
                                        </span>
                                    </div>
                                </div>

                                <!-- phonenumber field -->
                                <div class="col-12 col-md-6 p-0">
                                    <div class="user-input-wrp ms-md-5 me-md-2">
                                        <input type="text" name="phonenumber" id="phonenumber" value="{{phonenumber}}" maxlength="10" class="form-control"
                                            aria-label="phonenumber" placeholder=" " autocomplete="off" autofocus>
                                        <label class="floating-label">&nbsp;Contact No <span class="required">*</span> &nbsp;</label>
                                        <span id="phonenumber_error" class="error-div">
                                            {% if errors.phonenumber %}
                                                {{ errors.phonenumber }}
                                            {% endif %}
                                        </span>
                                    </div>
                                </div>

                                <!-- student date of birth field -->
                                <div class="col-12 col-md-6 p-0">
                                    <div class="user-input-wrp ms-4">
                                        <input type="date" name="date_of_birth" id="date_of_birth" class="form-control bg-white" placeholder=" "
                                            autocomplete="off" autofocus>
                                        <label class="floating-label">&nbsp;Date Of Birth&nbsp;</label>
                                        <span id="date_of_birth_error" class="error-div error-right">
                                            {% if errors.date_of_birth %}
                                                {{errors.date_of_birth}}
                                            {% endif %}
                                        </span>
                                    </div>
                                </div>

                                <!-- gender -->
                                <div class="col-12 col-md-6 p-0">
                                    <div class="user-input-wrp ms-md-5 pe-md-2">
                                        <select name="gender" id="gender" class="form-select select">
                                            <option value="" selected>Gender</option>
                                            <option value="Male">Male</option>
                                            <option value="Female">Female</option>
                                            <option value="Others">Other</option>
                                        </select>
                                        <label class="floating-label">&nbsp;Gender <span class="required">*</span> &nbsp;</label>
                                        <span id="gender_error" class="error-div">
                                            {% if errors.gender %}
                                                    {{errors.gender}}
                                            {% endif %}
                                        </span>
                                    </div>
                                </div>
  
                                <!-- email field -->
                                <div class="col-12 col-md-6 p-0">
                                    <div class="user-input-wrp ms-md-4">
                                        <input type="email" name="email_id" id="email_id" value="{{email_id}}" class="form-control" placeholder=" "
                                            autocomplete="off" autofocus>
                                        <label class="floating-label">&nbsp;E-Mail-ID <span class="required">*</span> &nbsp;</label>
                                        <span id="email_error" class="error-div error-right">
                                            {% if errors.email_id %}
                                                {{errors.email_id}}
                                            {% endif %}
                                        </span>
                                    </div>
                                </div>

                                <!-- student father name / guardian field -->
                                <div class="col-12 col-md-6 p-0">
                                    <div class="user-input-wrp ms-md-5 me-md-2">
                                        <input type="text" name="father_name" id="father_name" value="{{father_name}}" class="form-control" placeholder=" "
                                            autocomplete="off" autofocus>
                                        <label class="floating-label">&nbsp;Father/Guardian's Name&nbsp;</label>
                                        <span id="father_name_error" class="error-div error-right">
                                            {% if errors.fathers_name %}
                                                {{errors.fathers_name}}
                                            {% endif %}
                                        </span>
                                    </div>
                                </div>

                                <!-- Father's Contact No field -->
                                <div class="col-12 col-md-6 p-0">
                                    <div class="user-input-wrp ms-4">
                                        <input type="text" name="father_contact" id="fathers_contact_no" value="{{fathers_contact_no}}" maxlength="10" maxlength="10" class="form-control" placeholder=" "
                                            autocomplete="off" autofocus>
                                        <label class="floating-label">&nbsp;Father / Guardian's Contact No <span class="required">*</span> &nbsp;</label>
                                        <span id="father_contact_no_error" class="error-div error-right">
                                            {% if errors.fathers_contact_no %}
                                                {{errors.fathers_contact_no}}
                                            {% endif %}
                                        </span>
                                    </div>
                                </div>

                                <!-- Father email field -->
                                <div class="col-12 col-md-6 p-0">
                                    <div class="user-input-wrp ms-md-5 me-md-2">
                                        <input type="email" name="father_email" id="father_email" value="{{father_email_id}}" class="form-control" placeholder=" "
                                            autocomplete="off" autofocus>
                                        <label class="floating-label">&nbsp;Father / Guardian's E-Mail-ID&nbsp;</label>
                                        <span id="father_email_error" class="error-div error-right">
                                            {% if errors.father_email_id %}
                                                {{errors.father_email_id}}
                                            {% endif %}
                                        </span>
                                    </div>
                                </div>
                            
                                <div class="row d-flex justify-content-between">
                                    <div class="col-6 d-flex justify-content-md-end p-0 pe-4 pe-lg-4">
                                    </div>
                                    <div class="col-6 d-flex justify-content-lg-end ps-lg-4 p-0 ps-4 gap-5">
                                        <button class="btn login-btn" id="next-tab" onclick="next(event)">Next</button>
                                    </div>
                                </div>
                            
                                <span>
                                    {% if error_messages %}
                                    <div class="errors-common">
                                        <ul class="ul-errors">
                                            {% for field, message in error_messages.items %}
                                                {% if message %}
                                                    <li>{{ message }}</li>
                                                {% endif %}
                                            {% endfor %}
                                        </ul>
                                    </div>
                                    {% endif %}
                                </span>
                            </div>
                        </div>

                        <!-- Education details -->
                        <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                            <div class="col-12 mt-4 ms-md-3 position-relative">
                                <h5 class="fw-bold st-details">Education Details</h5>
                                <p class="user-para">Use the below form to update your profile</p>
                                <!-- <span class="message" id="message">{{message}}</span> -->
                            </div>

                            <div class="row">
                                <div class="row">
                                    <!-- degree field -->
                                    <div class="col-12 col-md-6">
                                        <div class="user-input-wrp ms-md-3 me-md-2">
                                            <input type="text" name="degree" id="degree" value="{{degree}}" class="form-control"
                                                aria-label="degree" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Degree/Diplomo <span class="required">*</span> &nbsp;</label>
                                            <span id="degree_error" class="error-div">
                                                {% if errors.degree %}
                                                    {{errors.degree}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- institution field -->
                                    <div class="col-12 col-md-6">
                                        <div class="user-input-wrp ms-md-2">
                                            <input type="text" name="institution" id="institution" value="{{institution}}" class="form-control"
                                                aria-label="institution" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Institution <span class="required">*</span> &nbsp;</label>
                                            <span id="institution_error" class="error-div">
                                                {% if errors.institution %}
                                                    {{errors.institution}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <!-- subject/area field -->
                                    <div class="col-12 col-md-6">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="text" name="subject" id="subject" value="{{subject}}" class="form-control"
                                                aria-label="subject" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Subject / Area <span class="required">*</span> &nbsp;</label>
                                            <span id="subject_error" class="error-div">
                                                {% if errors.subject %}
                                                    {{errors.subject}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <!-- grade-persentage field -->
                                    <div class="col-12 col-md-6">
                                        <div class="user-input-wrp ms-md-2 mt-md-4">
                                            <input type="text" name="grade_percentage" id="grade_percentage" value="{{grade_percentage}}" class="form-control"
                                                aria-label="collage" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Persentage of Marks / CGPA  <span class="required">*</span> &nbsp;</label>
                                            <span id="grade_percentage_error" class="error-div">
                                                {% if errors.grade_percentage %}
                                                    {{errors.grade_percentage}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                </div>

                                <div class="row">
                                    <!-- Place field -->
                                    <div class="col-12 col-md-6">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="text" name="place" id="place" value="{{place}}" class="form-control"
                                                aria-label="place" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Place&nbsp;</label>
                                            <span id="place_error" class="error-div">
                                                {% if errors.place %}
                                                    {{errors.place}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Year of Passed Out field -->
                                    <div class="col-12 col-md-6">
                                        <div class="user-input-wrp ms-md-2 mt-md-4">
                                            <input type="text" name="year_of_passed_out" id="year_of_passed_out" value="{{year_of_passed_out}}" class="form-control"
                                                aria-label="place" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Year of Passed Out <span class="required">*</span> &nbsp;</label>
                                            <span id="year_of_passed_out_error" class="error-div">
                                                {% if errors.year_of_passed_out %}
                                                    {{errors.year_of_passed_out}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div class="experience">
                                    <!-- Work Experience field -->
                                    <p class="experience_p">Work Experience</p>
                                    <input id="yes" type="radio" name="s" onclick="handleWorkExperienceChange()"><label for="yes">&nbsp;Yes</label>
                                    <input id="no" type="radio" name="s" onclick="handleWorkExperienceChange()"><label for="no">&nbsp;No</label>
                                    <span id="experience_error" class="error-div">
                                        {% if errors.work_experience %}
                                            {{errors.work_experience}}
                                        {% endif %}
                                    </span>
                                </div>
                                
                                <div class="row">
                                    <!-- Designation field -->
                                    <div class="col-12 col-md-6"  style="display: none;" id="designation_div">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="text" name="designation" id="designation" value="{{designation}}" class="form-control"
                                                aria-label="designation" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Designation <span class="required">*</span> &nbsp;</label>
                                            <span id="designation_error" class="error-div">
                                                {% if errors.designation %}
                                                    {{errors.designation}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Company Name field -->
                                    <div class="col-12 col-md-6 pe-md-0"  style="display: none;" id="company_name_div">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="text" name="company_name" id="company_name" value="{{company_name}}" class="form-control"
                                                aria-label="company_name" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Company Name <span class="required">*</span> &nbsp;</label>
                                            <span id="company_name_error" class="error-div">
                                                {% if errors.company_name %}
                                                    {{errors.company_name}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <!-- Work Experience field -->
                                    <div class="col-12 col-md-6"  style="display: none;" id="work_experience_div">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="text" name="work_experience" id="work_experience" value="{{work_experience}}" class="form-control"
                                                aria-label="work_experience" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Work Experience <span class="required">*</span> &nbsp;</label>
                                            <span id="work_experience_error" class="error-div">
                                                {% if errors.work_experience %}
                                                    {{errors.work_experience}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Nature of Work field -->
                                    <div class="col-12 col-md-6 pe-md-0"  style="display: none;" id="nature_of_work_div">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="text" name="nature_of_work" id="nature_of_work" value="{{nature_of_work}}" class="form-control"
                                                aria-label="nature_of_work" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Nature of Work <span class="required">*</span> &nbsp;</label>
                                            <span id="nature_of_work_error" class="error-div">
                                                {% if errors.nature_of_work %}
                                                    {{errors.nature_of_work}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>

                            <!-- Registration Details -->
                        
                            <div class="col-12 mt-4 ms-md-3 position-relative">
                                <h5 class="fw-bold st-details">Registration Details</h5>
                                <p class="user-para">Use the below form to update your profile</p>
                                <!-- <span class="message" id="message">{{message}}</span> -->
                            </div>

                            <div class="row">
                                <div class="row">
                                
                                    <!-- Course Name field -->
                                    <div class="col-12 col-md-6 pe-md-0">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <select class="form-select select" id="course_name" name="course_name" onclick="handleCourseNameChange()">
                                                <option value="" selected>Select Your Course</option>
                                                {% for course in courses %}
                                                    <option value="{{ course.id }}" {% if course_name == course.id %}selected{% endif %}>{{ course.course_name }}</option>
                                                {% endfor %}
                                            </select>
                                            <label for="course_name" class="floating-label float">&nbsp;Course Name <span class="required">*</span> &nbsp;</label>
                                            <span id="course_name_error" class="error-div error-right">
                                                {% if errors.course_name %}
                                                    {{errors.course_name}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Duration -->
                                    <div class="col-12 col-md-6 pe-md-0" id="duration_div">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="text" name="duration" value="{{duration}}" id="duration" class="form-control"
                                                aria-label="Duration" placeholder=" " autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Duration <span class="required">*</span> &nbsp;</label>
                                            <span id="duration_error" class="error-div">
                                                {% if errors.duration %}
                                                        {{errors.duration}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Inplant Technology field -->
                                    <div class="col-12 col-md-6 pe-md-0" style="display: none;" id="technology_div">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="text" name="inplant_technology" id="technology" value="{{inplant_technology}}" class="form-control" placeholder=" "
                                                autocomplete="off">
                                            <label class="floating-label">&nbsp;Technology <span class="required">*</span> &nbsp;</label>
                                            <span id="technology_error" class="error-div error-right">
                                                {% if errors.inplant_technology %}
                                                    {{errors.inplant_technology}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <!-- Internship Technology field -->
                                    <div class="col-12 col-md-6 pe-md-0" style="display: none;" id="internship_technology_div">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="text" name="internship_technology" id="internship_technology" value="{{internship_technology}}" class="form-control" placeholder=" "
                                                autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Technology <span class="required">*</span> &nbsp;</label>
                                            <span id="internship_technology_error" class="error-div error-right">
                                                {% if errors.internship_technology %}
                                                    {{errors.internship_technology}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    
                                    <!-- No.of Days field -->
                                    <div class="col-12 col-md-6 pe-md-0"  style="display: none;" id="no_of_days_div">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="number" name="inplant_no_of_days" id="inplant_no_of_days" value="{{inplant_no_of_days}}" class="form-control" placeholder=" "
                                                autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;No.of Days <span class="required">*</span> &nbsp;</label>
                                            <span id="inplant_no_of_days_error" class="error-div error-right">
                                                {% if errors.inplant_no_of_days %}
                                                    {{errors.inplant_no_of_days}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- No.of Students -->
                                    <div class="col-12 col-md-6 pe-md-0" style="display: none;" id="no_of_students_div">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="number" name="inplant_no_of_students" id="inplant_no_of_students" value="{{inplant_no_of_students}}" class="form-control" placeholder=" "
                                                autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;No.of Students <span class="required">*</span> &nbsp;</label>
                                            <span id="inplant_no_of_students_error" class="error-div error-right">
                                                {% if errors.inplant_no_of_students %}
                                                    {{errors.inplant_no_of_students}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                
                                    <!-- No.of Days field -->
                                    <div class="col-12 col-md-6 pe-md-0"  style="display: none;" id="internship_no_of_days_div">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="number" name="internship_no_of_days" id="internship_no_of_days" value="{{internship_no_of_days}}" class="form-control" placeholder=" "
                                                autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;No.of Days <span class="required">*</span> &nbsp;</label>
                                            <span id="internship_no_of_days_error" class="error-div error-right">
                                                {% if errors.internship_no_of_days %}
                                                    {{errors.internship_no_of_days}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- No.of Students -->
                                    <div class="col-12 col-md-6 pe-md-0" style="display: none;" id="internship_no_of_students_div">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="number" name="internship_no_of_students" id="internship_no_of_students" value="{{internship_no_of_students}}" class="form-control" placeholder=" "
                                                autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;No.of Students <span class="required">*</span> &nbsp;</label>
                                            <span id="internship_no_of_students_error" class="error-div error-right">
                                                {% if errors.internship_no_of_students %}
                                                    {{errors.internship_no_of_students}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <!-- Payment Type -->
                                    <div class="col-12 col-md-6 pe-md-0">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <select class="form-select select" name="payment_type" id="payment_type" onchange="handlePaymentTypeChange()">
                                                <option value="" selected>Select Your Payment Type</option>
                                                <option class="option" value="Single Payment">Single Payment</option>
                                                <option class="option" value="Installment">Installment</option>
                                            </select>
                                            <label class="floating-label">&nbsp;Select Your Payment Type <span class="required">*</span> &nbsp;</label>
                                            <span id="payment_type_error" class="error-div error-right">
                                                {% if errors.payment_type %}
                                                    {{errors.payment_type}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <!-- Total Fees Amount field -->
                                    <div class="col-12 col-md-6 pe-md-0">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="text" name="total_fees_amount" value="{{total_fees_amount}}" id="total_fees_amount" maxlength="10" class="form-control" placeholder=" "
                                                autocomplete="off" autofocus>
                                            <label class="floating-label">&nbsp;Total Fees Amount <span class="required">*</span> &nbsp;</label>
                                            <span id="total_fees_amount_error" class="error-div error-right">
                                                {% if errors.total_fees_amount %}
                                                        {{errors.total_fees_amount}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <!-- Installment Amount field -->
                                    <div class="col-12 col-md-6 pe-md-0" id="installment_div" style="display: none;">
                                        <div class="user-input-wrp ms-md-3 me-md-2 mt-md-4">
                                            <input type="text" name="installment_amount" value="{{installment_amount}}" id="installment_amount" maxlength="10" class="form-control" placeholder=" "
                                                autocomplete="off" autofocus onclick="handlePaymentTypeChange()">
                                            <label class="floating-label">&nbsp;Installment Amount <span class="required">*</span> &nbsp;</label>
                                            <span id="installment_amount_error" class="error-div error-right">
                                                {% if errors.installment_amount %}
                                                    {{errors.installment_amount}}
                                                {% endif %}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="row d-flex justify-content-between">
                                    <div class="col-6 d-flex justify-content-md-end p-0 pe-4 pe-lg-4">
                                    </div>
                                    <div class="col-6 d-flex justify-content-lg-end ps-lg-4 p-0 ps-4 gap-5">
                                        <button class="btn login-btn nav-link active " id="student-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">Back</button>
                                        <button class="btn login-btn" onclick="submitForm(event)">Submit</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- </div> -->

{% endblock %}


{% block scripts %}

<!-- Flatpickr JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script>

document.addEventListener('DOMContentLoaded', function() {
    const enquiryNoField = document.getElementById('enquiry_no');
    
    enquiryNoField.addEventListener('change', function() {
        const enquiry_no = this.value;
        if (enquiry_no) {
            fetch(`/get-enquiry-details/?enquiry_no=${encodeURIComponent(enquiry_no)}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log("Fetched data:", data);
                    if (data.error) {
                        console.error("Error returned by API:", data.error);
                        alert(data.error);
                        clearFields();
                    } else {
                        populateFields(data);
                    }
                })
                .catch(error => {
                    // alert('Error fetching enquiry details.');
                    console.error('There was a problem with the fetch operation:', error);
                    // window.location.reload()
                });
        }
    });
    
    function populateFields(data) {
        console.log('Populating fields with data:', data); // Debugging line
        const setValueIfExists = (fieldId, value) => {
            const field = document.getElementById(fieldId);
            if (field) {
                field.value = value || '';
            } else {
                console.warn(`Field with id "${fieldId}" not found.`);
            }
        };

        setValueIfExists('name', data.name);
        setValueIfExists('phonenumber', data.contact_no);
        setValueIfExists('date_of_birth', data.date_of_birth);
        setValueIfExists('email_id', data.email_id);
        setValueIfExists('father_name', data.fathers_name);
        setValueIfExists('fathers_contact_no', data.fathers_contact_no);
        setValueIfExists('degree', data.degree);
        setValueIfExists('grade_percentage', data.grade_percentage);
        setValueIfExists('institution', data.college);
        setValueIfExists('year_of_passed_out', data.year_of_graduation);
        // Handle Inplant and Internship fields

        setValueIfExists('inplant_technology', data.inplant_technology);
        setValueIfExists('inplant_no_of_days', data.inplant_no_of_days !== null ? data.inplant_no_of_days : ''); // Handle null
        setValueIfExists('inplant_no_of_students', data.inplant_no_of_students !== null ? data.inplant_no_of_students : ''); // Handle null
        setValueIfExists('internship_technology', data.internship_technology);
        setValueIfExists('internship_no_of_days', data.internship_no_of_days !== null ? data.internship_no_of_days : ''); // Handle null
        setValueIfExists('internship_no_of_students', data.internship_no_of_students !== null ? data.internship_no_of_students : ''); // Handle null

        // Match course_name with the dropdown option
        const courseDropdown = document.getElementById('course_name');
        if (courseDropdown) {
            let courseFound = false;
            const selectedCourseName = data.course_name.trim().toLowerCase();
            console.log("Course to match:", selectedCourseName); // Debugging line

            for (let i = 0; i < courseDropdown.options.length; i++) {
                const optionText = courseDropdown.options[i].textContent.trim().toLowerCase();

                if (optionText === selectedCourseName) {
                    courseDropdown.selectedIndex = i;
                    courseFound = true;
                    console.log("Matched course at index:", i);
                    break;
                }
            }

            if (!courseFound) {
                console.warn("Course name not found in the dropdown:", selectedCourseName);
            }
        } else {
            console.warn('Course dropdown field with id "course_name" not found.');
        }
    }
});

    // // tab functionality
    // document.getElementById('next-tab').addEventListener('click', function () {
    //     event.preventDefault();
    //     var profileTab = new bootstrap.Tab(document.getElementById('profile-tab'));
    //     profileTab.show();
    // });
    
    // document.getElementById('student-tab').addEventListener('click', function () {
    //     event.preventDefault();
    //     var profileTab = new bootstrap.Tab(document.getElementById('home-tab'));
    //     profileTab.show();
    // });

    // dropdown functionality
    function toggleDropdown(element) {
        // Close all dropdowns
        const allDropdowns = document.querySelectorAll('.dropdown-menu');
        allDropdowns.forEach(dropdown => {
            if (dropdown !== element.nextElementSibling) {
                dropdown.classList.remove('show');
            }
        });

        // Close all arrows
        const allArrows = document.querySelectorAll('.right_arrow');
        allArrows.forEach(arrow => {
            if (arrow !== element.querySelector('.right_arrow')) {
                arrow.classList.remove('arrow_user');
            }
        });

        // Toggle the clicked dropdown and arrow
        const dropdownMenu = element.nextElementSibling;
        dropdownMenu.classList.toggle('show');
        const rightArrow = element.querySelector('.right_arrow');
        rightArrow.classList.toggle('arrow_user');
    }

    document.getElementById('toggle-sidenav').addEventListener('click', function () {
        const sidenav = document.getElementById('sidenav');
        sidenav.classList.toggle('collapsed');
    });
    

    function showMessage() {
        const alertBox = document.getElementById('message');
        alertBox.style.display = 'block';

        setTimeout(() => {
            alertBox.style.display = 'none';
        }, 5000);
    }

    document.addEventListener('DOMContentLoaded', () => showMessage());

    
    function handleCourseNameChange() {
        console.log("Function called");

        const courseNameElement = document.getElementById('course_name');
        const courseName = courseNameElement.options[courseNameElement.selectedIndex].text.trim().toLowerCase();
        console.log("Selected Course Name:", courseName);

        const elements = {
            technologyDiv: document.getElementById('technology_div'),
            daysDiv: document.getElementById('no_of_days_div'),
            studentsDiv: document.getElementById('no_of_students_div'),
            internshipDiv: document.getElementById('internship_technology_div'),
            internshipDaysDiv: document.getElementById('internship_no_of_days_div'),
            internshipStudentsDiv: document.getElementById('internship_no_of_students_div'),
            durationDiv: document.getElementById('duration_div'), // This is the course duration div

            technologyInput: document.getElementById('technology'),
            daysInput: document.getElementById('inplant_no_of_days'),
            studentsInput: document.getElementById('inplant_no_of_students'),
            internshipInput: document.getElementById('internship_technology'),
            internshipDaysInput: document.getElementById('internship_no_of_days'),
            internshipStudentsInput: document.getElementById('internship_no_of_students')
        };

        // Hide all fields and remove required attributes for both sets
        Object.values(elements).forEach(el => {
            if (el.tagName === 'DIV') {
                el.style.display = 'none'; // Hide the divs
            } else if (el.tagName === 'INPUT') {
                el.value = ''; // Optionally clear the values of the input fields
            }
        });

        // Show relevant fields based on the selected course
        if (courseName === 'inplant training') {
            elements.technologyDiv.style.display = 'block';
            elements.daysDiv.style.display = 'block';
            elements.studentsDiv.style.display = 'block';

        } else if (courseName === 'internship training') {
            elements.internshipDiv.style.display = 'block';
            elements.internshipDaysDiv.style.display = 'block';
            elements.internshipStudentsDiv.style.display = 'block';

        } else {
            // If no course is selected or it's another course, show the duration field
            elements.durationDiv.style.display = 'block';
        }
    }


    function handlePaymentTypeChange() {
        console.log("Function called");

        const paymentTypeElement = document.getElementById('payment_type');
        const paymentType = paymentTypeElement.value.trim().toLowerCase();
        console.log("Selected Payment Type:", paymentType);

        const installmentDiv = document.getElementById('installment_div');
        const installmentAmountInput = document.getElementById('installment_amount');

        if (paymentType === 'installment') {
            // Show installment amount field and make it required
            installmentDiv.style.display = 'block';
            installmentAmountInput.setAttribute('required', 'required');
        } else {
            // Hide installment amount field and remove required attribute
            installmentDiv.style.display = 'none';
            installmentAmountInput.removeAttribute('required');
            installmentAmountInput.value = ''; // Optionally clear the value
        }
    }



    // Ensure the function runs on DOMContentLoaded
    document.addEventListener('DOMContentLoaded', () => handleCourseNameChange());

    function handleWorkExperienceChange() {
        // Get the elements for the work experience fields
        let designation_div = document.getElementById('designation_div');
        let company_name_div = document.getElementById('company_name_div');
        
        let work_experience_div = document.getElementById('work_experience_div');
        let nature_of_work_div = document.getElementById('nature_of_work_div');

        // Check if the "Yes" radio button is selected
        let workExperienceYes = document.getElementById('yes').checked;

        console.log("Work Experience Yes:", workExperienceYes);

        // clearErrors(); // Clear previous error messages

        // Show or hide fields based on the selection
        let displayStyle = workExperienceYes ? 'block' : 'none';
        designation_div.style.display = displayStyle;
        company_name_div.style.display = displayStyle;
        work_experience_div.style.display = displayStyle;
        nature_of_work_div.style.display = displayStyle;
    }

    function validateFirstTab() {
        let hasError = false;

        const enquiry_no = document.getElementById('enquiry_no');
        if (enquiry_no.value.trim() === "") {
            document.getElementById('enquiry_no_error').innerText = "Enquiry Number Field is required.";
            hasError = true;
        } else {
            document.getElementById('enquiry_no_error').innerText = "";
        }

        const name = document.getElementById('name');
        if (name.value.trim() === "") {
            document.getElementById('name_error').innerText = "Student Name Field is required.";
            hasError = true;
        } else {
            document.getElementById('name_error').innerText = "";
        }

        const phonenumber = document.getElementById('phonenumber');
        const phoneValue = phonenumber.value.trim();
        if (phoneValue === "") {
            document.getElementById('phonenumber_error').innerText = "Contact Field is required.";
            hasError = true;
        } else if (phoneValue.length !== 10 || isNaN(phoneValue)) {
            document.getElementById('phonenumber_error').innerText = "Please enter a valid 10-digit contact number.";
            hasError = true;
        } else {
            document.getElementById('phonenumber_error').innerText = "";
        }

        const fathers_contact_no = document.getElementById('fathers_contact_no');
        const fathers_contact = fathers_contact_no.value.trim();
        if (fathers_contact === "") {
            document.getElementById('father_contact_no_error').innerText = "Contact Field is required.";
            hasError = true;
        } else if (fathers_contact.length !== 10 || isNaN(phoneValue)) {
            document.getElementById('father_contact_no_error').innerText = "Please enter a valid 10-digit contact number.";
            hasError = true;
        } else {
            document.getElementById('father_contact_no_error').innerText = "";
        }

        const gender = document.getElementById('gender');
        if (gender.value.trim() === "") {
            document.getElementById('gender_error').innerText = "Gender Field is required.";
            hasError = true;
        } else {
            document.getElementById('gender_error').innerText = "";
        }

        // Email Validation
        const emailField = document.getElementById('email_id');
        const emailError = document.getElementById('email_error');
        const emailValue = emailField.value.trim();
        const emailPattern = /^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$/;

        if (emailValue === "") {
            emailError.textContent = "Email field is required.";
            hasError = true;
        } else if (!emailPattern.test(emailValue)) {
            emailError.textContent = "Please enter a valid email address.";
            hasError = true;
        } else {
            emailError.textContent = "";
        }

        console.log("Error : ", !hasError);
        return !hasError;
    }

    function validateSecondTab() {
        console.log("Validate Second Tab!!!")
        let hasError = false;

        // Degree Validation
        const degree = document.getElementById('degree');
        if (degree.value.trim() === "") {
            document.getElementById('degree_error').innerText = "Degree Field is required.";
            hasError = true;
        } else {
            document.getElementById('degree_error').innerText = "";
        }

        // Institution Field Validation
        const college = document.getElementById('institution');
        if (college.value.trim() === "") {
            document.getElementById('institution_error').innerText = "Institution Field is required.";
            hasError = true;
        } else {
            document.getElementById('institution_error').innerText = "";
        }

        // subject Field Validation
        const subject = document.getElementById('subject');
        if (subject.value.trim() === "") {
            document.getElementById('subject_error').innerText = "Subject Field is required.";
            hasError = true;
        } else {
            document.getElementById('subject_error').innerText = "";
        }

        // Grade Persentage Field Validation
        const grade_percentage = document.getElementById('grade_percentage');
        if (grade_percentage.value.trim() === "") {
            document.getElementById('grade_percentage_error').innerText = "Grade Percentage Field is required.";
            hasError = true;
        } else {
            document.getElementById('grade_percentage_error').innerText = "";
        }

        // Year of Passed out Field Validation
        const year_of_passed_out = document.getElementById('year_of_passed_out').value.trim();
        if (year_of_passed_out === "") {
            document.getElementById('year_of_passed_out_error').innerText = "Year of Passed Out Field is required.";
            hasError = true;
        } else {
            document.getElementById('year_of_passed_out_error').innerText = "";
        }

        // Payment Type Field Validation
        const yes = document.getElementById('yes').checked;
        const designation_div = document.getElementById('designation_div');
        const company_name_div = document.getElementById('company_name_div');
        const work_experience_div = document.getElementById('work_experience_div');
        const nature_of_work_div = document.getElementById('nature_of_work_div');
        const designation = document.getElementById('designation').value.trim();
        const company_name = document.getElementById('company_name').value.trim();
        const work_experience = document.getElementById('work_experience').value.trim();
        const nature_of_work = document.getElementById('nature_of_work').value.trim();
        if(yes){
            console.log("Yes : ", yes === "true")
            // Designation Field Validation
            if (designation_div.style.display === "block") {
                if(designation === ""){
                    document.getElementById('designation_error').innerText = "Designation Field is required.";
                    hasError = true;
                } else {
                    document.getElementById('designation_error').innerText = "";
                }
            }
            
            // Company Name Field Validation
            if (company_name_div.style.display === "block") {
                if(company_name === ""){
                    document.getElementById('company_name_error').innerText = "Company Name Field is required.";
                    hasError = true;
                } else {
                    document.getElementById('company_name_error').innerText = "";
                }
            }
            
            // Work Experience Field Validation
            if (work_experience_div.style.display === "block") {
                if(work_experience === ""){
                    document.getElementById('work_experience_error').innerText = "Work Experience Field is required.";
                    hasError = true;
                } else {
                    document.getElementById('work_experience_error').innerText = "";
                }
            }
            
            // Nature of Work Field Validation
            if (nature_of_work_div.style.display === "block") {
                if(nature_of_work === ""){
                    document.getElementById('nature_of_work_error').innerText = "Nature of Work Field is required.";
                    hasError = true;
                } else {
                    document.getElementById('nature_of_work_error').innerText = "";
                }
            }
        }

        // Course Name Field Validation
        const course_name = document.getElementById('course_name').value.trim();
        if (course_name === "") {
            document.getElementById('course_name_error').innerText = "Course Name Field is required.";
            hasError = true;
        } else {
            document.getElementById('course_name_error').innerText = "";
        }
        
        // Duration Field Validation
        const duration = document.getElementById('duration').value.trim();
        if (duration === "") {
            document.getElementById('duration_error').innerText = "Duration Field is required.";
            hasError = true;
        } else {
            document.getElementById('duration_error').innerText = "";
        }
        
        // Payment Type Field Validation
        const payment_type = document.getElementById('payment_type').value.trim();
        if (payment_type === "") {
            document.getElementById('payment_type_error').innerText = "Payment Type Field is required.";
            hasError = true;
        } else {
            document.getElementById('payment_type_error').innerText = "";
        }
        
        // Payment Type Field Validation
        const installment_div = document.getElementById('installment_div');
        const installment_amount = document.getElementById('installment_amount').value.trim();
        if (installment_div.style.display === "block") {
            if(installment_amount === ""){
                document.getElementById('installment_amount_error').innerText = "Installment Amount Field is required.";
                hasError = true;
            } else {
                document.getElementById('installment_amount_error').innerText = "";
            }
        }

        // Payment Type Field Validation
        const total_fees_amount = document.getElementById('total_fees_amount').value.trim();
        if (total_fees_amount === "") {
            document.getElementById('total_fees_amount_error').innerText = "Total Fees Amount Field is required.";
            hasError = true;
        } else {
            document.getElementById('total_fees_amount_error').innerText = "";
        }

        return !hasError; // Return true if no errors
    }

    function next(event) {
        event.preventDefault(); // Prevent default behavior

        // Validate the first tab fields
        if (validateFirstTab()) {
            // Switch to the next tab if valid
            console.log("Valid!!!");
            document.querySelector('.tab-pane.active').classList.remove('show', 'active');
            document.getElementById('profile').classList.add('show', 'active');
        } else {
            // Focus on the first invalid input
            console.log("In Valid!!!");
            const firstErrorElement = document.querySelector('.error-div');
            if (firstErrorElement) {
                firstErrorElement.previousElementSibling.focus();
            }
        }
    }

    function submitForm(event) {
        event.preventDefault();

        if (validateSecondTab()) {
            // Here you can handle form submission, e.g., sending data to the server
            document.getElementById("enrollment_form").submit();
        } else {
            const firstErrorElement = document.querySelector('.error-div:not(:empty)');
            if (firstErrorElement) {
                firstErrorElement.previousElementSibling.focus();
            }
        }
    }

    function prev() {
        document.querySelector('.tab-pane.active').classList.remove('show', 'active');
        document.getElementById('home').classList.add('show', 'active');
    }

    document.addEventListener('DOMContentLoaded', function() {
        flatpickr("#registration_date", {
            dateFormat: "d-m-Y", // Customize the format to "DD-MM-YYYY"
            defaultDate: "today" // Optional: set default date
        });

        flatpickr("#date_of_birth", {
            dateFormat: "d-m-Y", // Customize the format to "DD-MM-YYYY"
            minDate: "today",          // Set the minimum date to today's date
            defaultDate: "today" // Optional: set default date
        });
    });

    function validateFields(inputValue, errorElementId) {
        const errorElement = document.getElementById(errorElementId);
        if (!errorElement) return false; // Ensure error element exists

        if (inputValue === '') {
            errorElement.innerText = "This Field is required.";
            return true;
        } else {
            errorElement.innerText = "";
            return false;
        }
    }

    function validateField(inputElement, errorElementId) {
        const errorElement = document.getElementById(errorElementId);
        if (!inputElement || !errorElement) {
            return; // Ensure elements exist
        }

        if (inputElement.value.trim() === '') {
            // If the field is empty, display an error message
            errorElement.innerText = "This field can't be empty";
            errorElement.innerText = "";
            inputElement.required = true;
        } else {
            // If the field has a value, clear the error message
            errorElement.innerText = "";
            inputElement.required = false;
        }
    }

    // function clearErrors() {
    //     const errorElements = document.querySelectorAll('.error-div');
    //     errorElements.forEach(element => {
    //         element.innerText = "";
    //     });
    // }

</script>
{% endblock %}